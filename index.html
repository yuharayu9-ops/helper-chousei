// --- 修正箇所（APIキーを画面に少しだけ表示して確認する） ---
const handleAIUpload = async (e, type) => {
    const file = e.target.files[0];
    if (!apiKey) {
        alert("エラー：APIキーが空っぽです！右上の欄に入力してください。");
        return;
    }
    alert("今からこのキーで通信します: " + apiKey.substring(0, 5) + "...");
    // ...
